<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Veerenstael KPI Tool</title>
  <link rel="stylesheet" href="style.css"/>
  <link rel="icon" href="favicon.png" type="image/png"/>
</head>
<body>
  <div class="dashboard-bg">
    <header class="logo-header">
      <img
        src="logo-veerenstael-wit.png"
        alt="Veerenstael Logo"
        class="veerenstael-logo"
      />
      <div class="subtitle-title">Inzicht in Betrouwbaarheids- en Onderhoudsparameters</div>
    </header>

    <div class="main-card">
      <div class="header center-header">
        <p>
          Bereken betrouwbaarheids- en onderhoudsparameters voor uw installaties en machines.
        </p>
      </div>

      <!-- Definitie-sectie -->
      <div class="definitions-section">
        <h3 class="definitions-title">📚 KPI Definities - Klik voor uitleg</h3>
        <div class="definitions-grid">
          <button type="button" class="def-btn" data-kpi="mttf">MTTF</button>
          <button type="button" class="def-btn" data-kpi="mtbf">MTBF</button>
          <button type="button" class="def-btn" data-kpi="mttr">MTTR</button>
          <button type="button" class="def-btn" data-kpi="availability">Beschikbaarheid [A]</button>
          <button type="button" class="def-btn" data-kpi="lambda">Failure Rate [λ]</button>
          <button type="button" class="def-btn" data-kpi="fit">FIT</button>
          <button type="button" class="def-btn" data-kpi="mtbm">MTBM</button>
          <button type="button" class="def-btn" data-kpi="mcmt">MCMT</button>
        </div>
        <div id="def-explanation" class="def-explanation" hidden>
          <div class="def-content"></div>
        </div>
      </div>

      <div class="content-grid">
        <!-- Linker kolom: Input + Resultaten -->
        <section class="left-column">
          <!-- Invoer -->
          <div class="input-section">
            <h2 class="section-title">Invoervelden</h2>
            <form id="kpi-form" autocomplete="off">
              <label for="totItemsValue">Totale bedrijfstijd van alle items</label>
              <div class="input-subtitle">Opgetelde draaiuren van alle geteste componenten</div>
              <div class="unit-row">
                <input type="number" id="totItemsValue" value="200000" step="1" min="0"/>
                <select id="totItemsUnit" aria-label="Eenheid totale bedrijfstijd van alle items">
                  <option value="hours" selected>uren</option>
                  <option value="days">dagen</option>
                  <option value="years">jaren</option>
                </select>
              </div>

              <label for="failedItems">Aantal falende items</label>
              <input type="number" id="failedItems" value="10" step="1" min="0"/>

              <label for="totHoursValue">Totale bedrijfstijd</label>
              <div class="input-subtitle">Totale draaiuren van de machine/installatie</div>
              <div class="unit-row">
                <input type="number" id="totHoursValue" value="35000" step="1" min="0"/>
                <select id="totHoursUnit" aria-label="Eenheid totale bedrijfstijd">
                  <option value="hours" selected>uren</option>
                  <option value="days">dagen</option>
                  <option value="years">jaren</option>
                </select>
              </div>

              <label for="failures">Aantal storingen</label>
              <input type="number" id="failures" value="7" step="1" min="0"/>

              <label for="totRepairHours">Totale hersteltijd (uren)</label>
              <input type="number" id="totRepairHours" value="56" step="0.1" min="0"/>

              <label for="pmCount">Aantal geplande onderhoudsacties</label>
              <input type="number" id="pmCount" value="22" step="1" min="0"/>

              <label for="cmCount">Aantal ongeplande onderhoudsacties</label>
              <input type="number" id="cmCount" value="9" step="1" min="0"/>

              <div class="button-row">
                <button type="submit" class="green">Bereken</button>
                <button type="reset" class="reset-btn">Reset</button>
              </div>

              <div id="warn" class="info-block" style="color:#ffcc99" hidden></div>
            </form>
          </div>

          <!-- Resultaten -->
          <div class="result-section">
            <h2 class="section-title">Resultaten</h2>
            
            <div class="result-unit-selector">
              <label for="resultUnit">Weergave eenheid:</label>
              <select id="resultUnit">
                <option value="hours" selected>Uren</option>
                <option value="days">Dagen</option>
                <option value="years">Jaren</option>
              </select>
            </div>
            
            <div class="result-grid">
              <div class="result-row">
                <span class="result-label">MTTF:</span>
                <span class="result-value"><span id="outMTTF">—</span> <span id="unitMTTF">uur</span></span>
              </div>
              <div class="result-row">
                <span class="result-label">MTBF:</span>
                <span class="result-value"><span id="outMTBF">—</span> <span id="unitMTBF">uur</span></span>
              </div>
              <div class="result-row">
                <span class="result-label">MTTR:</span>
                <span class="result-value"><span id="outMTTR">—</span> <span id="unitMTTR">uur</span></span>
              </div>
              <div class="result-row">
                <span class="result-label">Beschikbaarheid [A]:</span>
                <span class="result-value" id="outA">—</span>
              </div>
              <div class="result-row">
                <span class="result-label">Failure Rate [λ]:</span>
                <span class="result-value"><span id="outLambda">—</span> per uur</span>
              </div>
              <div class="result-row">
                <span class="result-label">FIT:</span>
                <span class="result-value"><span id="outFIT">—</span> per 10<sup>9</sup> uur</span>
              </div>
              <div class="result-row">
                <span class="result-label">MTBM:</span>
                <span class="result-value"><span id="outMTBM">—</span> <span id="unitMTBM">uur</span></span>
              </div>
              <div class="result-row">
                <span class="result-label">MCMT:</span>
                <span class="result-value"><span id="outMCMT">—</span> <span id="unitMCMT">uur</span></span>
              </div>
            </div>
            
            <button type="button" class="export-btn" id="exportPDF">📄 Exporteer PDF</button>
          </div>
        </section>

        <!-- Rechter kolom: Berekeningsformules -->
        <section class="right-column">
          <div class="formulas-section">
            <h2 class="section-title">Berekeningsformules</h2>
            <div class="formulas">
              <div class="formula-item">
                <span class="formula-label">MTTF =</span>
                <div class="fraction">
                  <span class="frac-num">[Totale bedrijfstijd van alle items]</span>
                  <span class="frac-line"></span>
                  <span class="frac-den">[Aantal falende items]</span>
                </div>
              </div>
              
              <div class="formula-item">
                <span class="formula-label">MTBF =</span>
                <div class="fraction">
                  <span class="frac-num">[Totale bedrijfstijd]</span>
                  <span class="frac-line"></span>
                  <span class="frac-den">[Aantal storingen]</span>
                </div>
              </div>
              
              <div class="formula-item">
                <span class="formula-label">MTTR =</span>
                <div class="fraction">
                  <span class="frac-num">[Totale hersteltijd]</span>
                  <span class="frac-line"></span>
                  <span class="frac-den">[Aantal storingen]</span>
                </div>
              </div>
              
              <div class="formula-item">
                <span class="formula-label">Beschikbaarheid [A] =</span>
                <div class="fraction">
                  <span class="frac-num">MTBF</span>
                  <span class="frac-line"></span>
                  <span class="frac-den">(MTBF + MTTR)</span>
                </div>
              </div>
              
              <div class="formula-item">
                <span class="formula-label">Failure rate [λ] =</span>
                <div class="fraction">
                  <span class="frac-num">[Aantal storingen]</span>
                  <span class="frac-line"></span>
                  <span class="frac-den">[Totale bedrijfstijd]</span>
                </div>
              </div>
              
              <div class="formula-item">
                <span class="formula-label">FIT =</span>
                <span class="formula-simple">[λ] × 10<sup>9</sup></span>
              </div>
              
              <div class="formula-item">
                <span class="formula-label">MTBM =</span>
                <div class="fraction">
                  <span class="frac-num">[Totale bedrijfstijd]</span>
                  <span class="frac-line"></span>
                  <span class="frac-den">([Geplande acties] + [Ongeplande acties])</span>
                </div>
              </div>
              
              <div class="formula-item">
                <span class="formula-label">MCMT =</span>
                <div class="fraction">
                  <span class="frac-num">[Totale hersteltijd]</span>
                  <span class="frac-line"></span>
                  <span class="frac-den">[Aantal ongeplande acties]</span>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- Betrouwbaarheidsvisualisatie -->
      <div class="visualization-card">
        <h2 class="chart-title">Betrouwbaarheidsvisualisatie</h2>
        
        <div class="visualization-grid">
          <!-- Linker kolom: Timeline diagram -->
          <div class="timeline-section">
            <svg id="timelineSvg" width="100%" height="280" viewBox="0 0 800 280">
              <!-- Timeline wordt door JavaScript gevuld -->
            </svg>
            
            <!-- Info boxes voor MTBM en MCMT -->
            <div class="info-boxes">
              <div class="info-box mtbm-box">
                <span class="info-icon">📅</span>
                <div class="info-content">
                  <div class="info-label">MTBM</div>
                  <div class="info-value" id="visMTBM">—</div>
                </div>
              </div>
              <div class="info-box mcmt-box">
                <span class="info-icon">⚙️</span>
                <div class="info-content">
                  <div class="info-label">MCMT</div>
                  <div class="info-value" id="visMCMT">—</div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Rechter kolom: Beschikbaarheid gauge -->
          <div class="gauge-section">
            <h3 class="gauge-title">Beschikbaarheid</h3>
            <svg id="availabilityGauge" width="100%" height="200" viewBox="0 0 240 160">
              <!-- Gauge wordt door JavaScript gevuld -->
            </svg>
            <div class="gauge-value" id="gaugeValue">—</div>
          </div>
        </div>
        
        <!-- Failure Rate onderaan -->
        <div class="failure-rate-section">
          <span class="failure-icon">⚠️</span>
          <span class="failure-text">
            Failure Rate [λ]: <strong id="visLambda">—</strong> per uur
            <span class="failure-interpretation" id="visLambdaInterpretation"></span>
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- jsPDF voor PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <!-- Logica -->
  <script src="main.js"></script>
</body>
</html>
